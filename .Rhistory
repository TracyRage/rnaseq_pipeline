head(20) %>%
ggplot(aes(fill = pathway_name, values = counts)L) +
PY_UP_2 %>%
dplyr::count(pathway_name, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(20) %>%
ggplot(aes(fill = pathway_name, values = counts)) +
geom_waffle(n_rows = 20, size = 0.33, colour = "white", flip = TRUE) +
coord_equal() +
theme_enhance_waffle() %>%
labs(legend)
PY_UP_2 %>%
dplyr::count(pathway_name, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(20) %>%
ggplot(aes(fill = pathway_name, values = counts)) +
geom_waffle() +
coord_equal() +
theme_enhance_waffle() %>%
labs(legend)
PY_UP_2 %>%
dplyr::count(pathway_name, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = pathway_name, values = counts)) +
geom_waffle() +
coord_equal() +
theme_enhance_waffle() %>%
labs(legend)
PY_UP_2 %>%
dplyr::count(pathway_name, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
rename(`Căi metabolice` = pathway_name) %>%
head(15) %>%
ggplot(aes(fill = pathway_name, values = counts)) +
geom_waffle() +
coord_equal() +
theme_enhance_waffle() %>%
labs(legend)
PY_UP_2
PY_UP_2 %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(pathway_name, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = pathway_name, values = counts)) +
geom_waffle() +
coord_equal() +
theme_enhance_waffle() %>%
labs(legend)
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
PY_UP_2 %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle() +
coord_equal() +
theme_enhance_waffle() %>%
labs(legend)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle() +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
PY_UP_waffle
PY_UP_waffle <- get_waffle(PY_UP_2)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
install.packages("patchwork")
(PHE_UP_waffle + PY_UP_waffle) / (PHE_DOWN_waffle + PY_DOWN_waffle)
PHE_UP_waffle + PY_UP_waffle
PY_UP_2
PY_DOWN_2
BOTH_2
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name) %>%
mutate(factor = "PY_UP")
PY_UP_2
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name) %>%
mutate(factor = "PY_DOWN")
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name) %>%
mutate(factor = "PHE_UP")
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name) %>%
mutate(factor = "PHE_DOWN")
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
BOTH_2
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle() +
facet_wrap(~factor, ncol=2)
coord_equal() +
theme_enhance_waffle()
}
get_waffle(BOTH_2)
BOTH_2
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T)
get_waffle(BOTH_2)
BOTH_2 %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle() +
facet_wrap(~factor, ncol=2)
BOTH_2
BOTH_2 %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15)
BOTH_2 %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, factor, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15)
coord_equal() +
theme_enhance_waffle()
BOTH_2 %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, factor, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle() +
facet_wrap(~factor, ncol=2) +
coord_equal() +
theme_enhance_waffle()
BOTH_2 %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, factor, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle() +
facet_wrap(~factor, ncol=2) +
coord_equal() +
theme_enhance_waffle()
PY_UP_waffle <- get_waffle(PY_UP_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle() +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
PY_UP_waffle
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
PY_UP_waffle
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
PY_DOWN_waffle
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_2)
?ggsave
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_2)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave(filename = "analysis_results/PHE_UP_waffle.png", plot = PHE_UP_2)
ggsave(filename = "analysis_results/PHE_UP_waffle.png", plot = PHE_UP_2, device = "png")
ggsave(plot = PHE_UP_2, filename = "analysis_results/PHE_UP_waffle.png", device = "png")
ggsave(plot = PHE_UP_2, filename = "PHE_UP_waffle.png", path = "analysis_results/", device = "png")
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_waffle)
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.png", plot = PY_DOWN_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.png", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_DOWN_waffle.png", plot = PHE_DOWN_waffle)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_waffle)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.png", plot = PY_DOWN_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.png", plot = PY_DOWN_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.png", plot = PHE_UP_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.png", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_UP_waffle.png", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_DOWN_waffle.png", plot = PHE_DOWN_waffle)
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 5) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.png", plot = PY_DOWN_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.png", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_DOWN_waffle.png", plot = PHE_DOWN_waffle)
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(15) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.png", plot = PY_DOWN_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.png", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_DOWN_waffle.png", plot = PHE_DOWN_waffle)
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(16) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.png", plot = PY_UP_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.png", plot = PY_DOWN_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.png", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_DOWN_waffle.png", plot = PHE_DOWN_waffle)
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(16) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.eps", plot = PY_UP_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.eps", plot = PY_DOWN_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.eps", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_DOWN_waffle.eps", plot = PHE_DOWN_waffle)
PY_UP_2 <- readr::read_csv("analysis_results/py_log_up.csv") %>%
select(gene, pathway_name)
PY_DOWN_2 <- readr::read_csv("analysis_results/py_log_down.csv") %>%
select(gene, pathway_name)
PHE_UP_2 <-  readr::read_csv("analysis_results/phe_log_up.csv") %>%
select(gene, pathway_name)
PHE_DOWN_2 <- readr::read_csv("analysis_results/phe_log_down.csv") %>%
select(gene, pathway_name)
BOTH_2 <- bind_rows(PY_UP_2, PY_DOWN_2, PHE_UP_2, PHE_DOWN_2) %>%
distinct(gene, .keep_all = T) %>%
rename(`Căi metabolice` = pathway_name,
Gene = gene)
column_data_2 <- column_data %>%
mutate(Treatment = case_when(str_detect(Treatment, "phenanthrene") ~ "fenantren",
str_detect(Treatment, "pyrene") ~ "piren",
TRUE ~ Treatment)) %>%
rename(Tratament = Treatment)
hm_2 <- render_final_hp_RO(rectified_set = set_s,
column_data = column_data_2,
row_data = BOTH_2)
get_waffle <- function(pathway_counts) {
pathway_counts %>%
rename(`Căi metabolice` = pathway_name) %>%
dplyr::count(`Căi metabolice`, sort = T, name="counts") %>%
arrange(desc(counts)) %>%
head(16) %>%
ggplot(aes(fill = `Căi metabolice`, values = counts)) +
geom_waffle(color = "white", size=1.125, n_rows = 6) +
coord_equal() +
theme_enhance_waffle()
}
PY_UP_waffle <- get_waffle(PY_UP_2)
ggsave("analysis_results/PY_UP_waffle.tiff", plot = PY_UP_waffle)
PY_DOWN_waffle <- get_waffle(PY_DOWN_2)
ggsave("analysis_results/PY_DOWN_waffle.tiff", plot = PY_DOWN_waffle)
PHE_UP_waffle <- get_waffle(PHE_UP_2)
ggsave("analysis_results/PHE_UP_waffle.tiff", plot = PHE_UP_waffle)
PHE_DOWN_waffle <- get_waffle(PHE_DOWN_2)
ggsave("analysis_results/PHE_DOWN_waffle.tiff", plot = PHE_DOWN_waffle)
renv::snapshot()
